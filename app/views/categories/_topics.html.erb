<% if @topics.empty? %>

	<p class="empty-resource-notice">There are no topics yet in this category.</p>

<% else %>
	<table class="table table-hover topics-table">
		<thead>
			<tr>
				<td class="topic">Topic</td>
				<td class="posts">Posts</td>
				<td class="author">Topic owner</td>
				<td class="activity">Activity</td>
			</tr>
		</thead>
		<tbody>
			<% @topics.each do |topic| %>
				<tr>

					<!-- Topic -->
					<td class="topic">
						<%= link_to topic.title, topic, class: "topic" %><br>
						<%= render 'edit_delete_topic_links', topic: topic %>
					</td>

					<!-- Replies -->
					<td class="posts">
						<span><%= topic.posts.count %></snap>
					</td>

					<!-- Author -->
					<td class="author">
						<%= render 'shared/user_avatar', user: topic.user %>
						<%= link_to topic.user.name, topic.user %>
					</td>

					<!-- Last activity -->
					<td class="activity">
						<% unless topic.posts.empty? %>
							<% last_post = topic.posts.last %>
							<%= link_to truncate(last_post.content, length: 40),
							 						topic_path(topic, anchor: last_post.anchor, page: topic.last_page),
													tooltip: CGI.unescapeHTML("Post: #{truncate(last_post.content, length: 100)}"),
													class: 'post-preview' %>
							<br>
							<span>by <%= link_to last_post.user.name, last_post.user %> </span>
						<% else %>
							<%= link_to truncate(topic.content, length: 40),
													topic_path(topic),
													tooltip: CGI.unescapeHTML("Topic: #{truncate(topic.content, length: 100)}"),
													class: 'post-preview' %>
							<br>
							<span>by <%= link_to topic.user.name, topic.user %> </span>
						<% end %>
						<span tooltip="<%= topic.last_activity %>">
							<%= time_ago_in_words(topic.last_activity) %> ago
						</span>
					</td>

				</tr>

			<% end %>
		</tbody>
	</table>
<% end %>
